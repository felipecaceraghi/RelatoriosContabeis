{
  "id": "9167c56a-39b3-4f46-98ec-e3c08739085e",
  "type": "balancete",
  "payload": {
    "codiEmp": 2394,
    "dataInicial": "2025-01-01",
    "dataFinal": "2025-07-31",
    "ingles": false
  },
  "status": "complete",
  "progress": 100,
  "result": {
    "raw": "============================================================\r\n🏢 SISTEMA DE GERAÇÃO DE BALANCETE CONTÁBIL\r\n============================================================\r\n\r\n📋 PARÂMETROS CONFIGURADOS:\r\n   • Empresa: 2394\r\n   • Período: 2025-01-01 a 2025-07-31\r\n   • Idioma: Português\r\n   • Assinatura de Arquivo: 20250828_102009\r\n\r\n🔍 Buscando parâmetros de configuração...\r\n\r\n--- Iniciando busca de parâmetros para Empresa: 2394 ---\r\nPasso 1: Buscando filiais para consolidação...\r\n  > Radical do CNPJ encontrado: 35019906\r\n  > Filiais encontradas para consolidação: [2395]\r\n  > Lista final de filiais para a consulta: [2394, 2395]\r\nPasso 2: Verificando ordenação especial...\r\n  > Regra de ordenação encontrada. Buscando detalhes...\r\n  > Classificações para ordenação especial: ['211011', '112001']\r\n\r\n--- Coleta de parâmetros finalizada com sucesso! ---\r\n\r\n⚡ Gerando consulta SQL otimizada...\r\n   ✅ Filtros rigorosos serão aplicados na camada de negócios (Python)\r\n   📊 Consulta SQL traz TODOS os dados - filtros aplicados depois\r\n   🇧🇷 Modo português - usando nomes originais das contas\r\n\r\n🔄 Executando consulta única consolidada...\r\n📊 Buscando dados do relatório...\r\n   ✅ 1403 linhas brutas encontradas em 9.21s\r\n   📊 Composição inicial: 243 sintéticas + 1160 analíticas\r\n🔍 Aplicando filtros de regras de negócio...\r\n   🔧 Aplicando filtros básicos...\r\n      ❌ 5 contas de Prejuízo (238) removidas\r\n      ✅ Contas 230 (Lucro) e 232 preservadas - apenas 238 (Prejuízo) removida\r\n      ❌ 814 contas analíticas completamente zeradas removidas\r\n   🔧 Aplicando filtros rigorosos...\r\n      ❌ 83 contas analíticas com saldos zerados removidas\r\n   📊 Resultado: 1403 → 501 linhas (241 sintéticas + 260 analíticas)\r\n   ✅ 902 linhas removidas pelos filtros\r\n📋 Buscando dados de cabeçalho e rodapé...\r\n🧮 Calculando totalização hierárquica...\r\n   Calculando totalização hierárquica (versão otimizada)...\r\n   DEBUG: Total de contas sintéticas: 241\r\n   DEBUG: Total de contas analíticas: 260\r\n   DEBUG: '11' -> 26 descendentes\r\n   DEBUG: '11' TOTAL = 4722825.41\r\n   DEBUG: '12' -> 8 descendentes\r\n   DEBUG: '12' TOTAL = 276568.25\r\n   DEBUG: '21' -> 152 descendentes\r\n   DEBUG: '21' TOTAL = -5933483.62\r\n   DEBUG: '22' -> 4 descendentes\r\n   DEBUG: '22' TOTAL = -1371981.07\r\n   ✅ Hierarquia calculada em 0.12s\r\n🗑️ Filtrando contas sintéticas zeradas sem descendentes...\r\n   ✅ 151 contas sintéticas zeradas removidas.\r\n   ✅ Transação confirmada (commit).\r\n\r\n📄 Gerando relatórios de saída...\r\n   Gerando PDF com 350 linhas...\r\n   Gerando XLSX 'Balancete_2394_2025-01-01_a_2025-07-31_20250828_102009.xlsx'...\r\n   Iniciando desenho da seção de resumo...\r\n\r\nPDF 'Balancete_2394_2025-01-01_a_2025-07-31_20250828_102009.pdf' gerado com sucesso!\r\n   XLSX 'Balancete_2394_2025-01-01_a_2025-07-31_20250828_102009.xlsx' gerado com sucesso!\r\n\r\n🎉 === PROCESSO CONCLUÍDO COM SUCESSO ===\r\n⏱️  Tempo total: 9.60 segundos\r\n📊 Consulta SQL: 9.21s\r\n🔍 Filtros de negócio: 0.02s\r\n🧮 Hierarquia: 0.12s\r\n📄 Geração de arquivos: 0.18s\r\n📁 Arquivos gerados:\r\n   • Balancete_2394_2025-01-01_a_2025-07-31_20250828_102009.pdf\r\n   • Balancete_2394_2025-01-01_a_2025-07-31_20250828_102009.xlsx\r\n\r\n📝 Renomeando arquivos...\r\nDebug: Iniciando renomeamento de Balancete_2394_2025-01-01_a_2025-07-31_20250828_102009.pdf\r\nDebug: Caminho completo: Balancete_2394_2025-01-01_a_2025-07-31_20250828_102009.pdf\r\nDebug: Arquivo existe: True\r\nDebug: Parâmetros - codi_emp: 2394, data_inicial: 2025-01-01, data_final: 2025-07-31, idioma_ingles: False\r\nDebug: Tipo de relatório identificado: balancete\r\nDebug: Nome da empresa: VECCHI MATRIZ\r\nDebug: Período 2025-01-01 a 2025-07-31, is_acumulado = True\r\nDebug: Novo nome gerado: VECCHI MATRIZ - Balancete Acumulado 07.2025 - Emitido em 28.08.2025.pdf\r\nDebug: Novo caminho: VECCHI MATRIZ - Balancete Acumulado 07.2025 - Emitido em 28.08.2025.pdf\r\nErro ao renomear arquivo Balancete_2394_2025-01-01_a_2025-07-31_20250828_102009.pdf: [WinError 183] Não é possível criar um arquivo já existente: 'Balancete_2394_2025-01-01_a_2025-07-31_20250828_102009.pdf' -> 'VECCHI MATRIZ - Balancete Acumulado 07.2025 - Emitido em 28.08.2025.pdf'\r\nDebug: Iniciando renomeamento de Balancete_2394_2025-01-01_a_2025-07-31_20250828_102009.xlsx\r\nDebug: Caminho completo: Balancete_2394_2025-01-01_a_2025-07-31_20250828_102009.xlsx\r\nDebug: Arquivo existe: True\r\nDebug: Parâmetros - codi_emp: 2394, data_inicial: 2025-01-01, data_final: 2025-07-31, idioma_ingles: False\r\nDebug: Tipo de relatório identificado: balancete\r\nDebug: Nome da empresa: VECCHI MATRIZ\r\nDebug: Período 2025-01-01 a 2025-07-31, is_acumulado = True\r\nDebug: Novo nome gerado: VECCHI MATRIZ - Balancete Acumulado 07.2025 - Emitido em 28.08.2025.xlsx\r\nDebug: Novo caminho: VECCHI MATRIZ - Balancete Acumulado 07.2025 - Emitido em 28.08.2025.xlsx\r\nErro ao renomear arquivo Balancete_2394_2025-01-01_a_2025-07-31_20250828_102009.xlsx: [WinError 183] Não é possível criar um arquivo já existente: 'Balancete_2394_2025-01-01_a_2025-07-31_20250828_102009.xlsx' -> 'VECCHI MATRIZ - Balancete Acumulado 07.2025 - Emitido em 28.08.2025.xlsx'\r\n🔌 Fechando a conexão com o banco de dados.\r\n{\"pdf\": \"Balancete_2394_2025-01-01_a_2025-07-31_20250828_102009.pdf\", \"xlsx\": \"Balancete_2394_2025-01-01_a_2025-07-31_20250828_102009.xlsx\"}\r\n",
    "code": 0
  },
  "error": null,
  "createdAt": 1756387208290,
  "startedAt": 1756387208292
}